

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/css/style.css">
    <title>
  C&#43;&#43; Quickstart &ndash; gRPC
</title>

		
		<link rel="apple-touch-icon" href="/favicons/apple-touch-icon.png" sizes="180x180">
		<link rel="icon" type="image/png" href="/favicons/android-chrome-192x192.png" sizes="192x192" >
		<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
		<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
		<link rel="manifest" href="/favicons/manifest.json">
		<link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#2DA6B0">
		<meta name="msapplication-TileColor" content="#ffffff">
		<meta name="msapplication-TileImage" content="/favicons/mstile-150x150.png">

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-60127042-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-60127042-1');
    </script>

  </head>
  <body>
    <div id="landing-content">
      <div class="row">
        <div class="topbannersub">
          <nav class="navbar navbar-expand-md navbar-dark topnav">
            <a class="navbar-brand" href="https://cjyabraham.github.io/">
              <img src="https://cjyabraham.github.io/img/grpc-logo.png" width="114" height="50">
            </a>

            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>

            <div class="topnav, collapse navbar-collapse" id="navbarSupportedContent" style="float:right !important">
              <ul class="navbar-nav ml-auto">
                <li class="nav-item ">
                  <a class="nav-link" href="https://cjyabraham.github.io/about/">About</a>
                </li>
                <li class="nav-item dropdown active">
                  <a class="nav-link dropdown-toggle" href="https://cjyabraham.github.io/docs/" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Docs
                  </a>

                  <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    
                    
                    <a class="dropdown-item" href="/docs">
                      Overview
                    </a>
                    
                    
                    <a class="dropdown-item" href="/docs/quickstart/">
                      Quick Start
                    </a>
                    
                    
                    <a class="dropdown-item" href="/docs/guides/">
                      Guides
                    </a>
                    
                    
                    <a class="dropdown-item" href="/docs/tutorials/">
                      Tutorials
                    </a>
                    
                    
                    <a class="dropdown-item" href="/docs/reference/">
                      Reference
                    </a>
                    
                    
                    <a class="dropdown-item" href="/docs/samples/">
                      Samples
                    </a>
                    
                    
                    <a class="dropdown-item" href="/docs/talks">
                      Presentations
                    </a>
                    
                  </div>
                </li>
                <li class="nav-item ">
                  <a class="nav-link" href="/blog">
                    Blog
                  </a> 
                </li>
                <li class="nav-item ">
                  <a class="nav-link" href="/community">Community</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="https://packages.grpc.io/">
                    Packages
                  </a> 
                </li>
                <li class="nav-item ">
                  <a class="nav-link" href="https://cjyabraham.github.io/faq/">FAQ</a>
                </li>
              </ul>
            </div>
          </nav>
          
          
            <div class="headertext">Documentation</div>
  </div>
        </div>
        </div>

    <div class="subnav d-none d-md-block">
  <a href="https://cjyabraham.github.io/docs/" >Overview</a>
|  <a href="https://cjyabraham.github.io/docs/quickstart/"  class="active">Quick Start</a>
|  <a href="https://cjyabraham.github.io/docs/guides/" >Guides</a>
|  <a href="https://cjyabraham.github.io/docs/tutorials/" >Tutorials</a>
|  <a href="https://cjyabraham.github.io/docs/reference/" >Reference</a>
|  <a href="https://cjyabraham.github.io/docs/samples/" >Samples</a>
|  <a href="https://cjyabraham.github.io/docs/talks/" >Presentations</a>
</div>


<div class="quickstartcols">

<div class="quickstartcol1">

<h8>Quick Start</h8>
<a href="https://cjyabraham.github.io/docs/quickstart/cpp/"  class="active">C++</a>
<a href="https://cjyabraham.github.io/docs/quickstart/csharp/" >C#</a>
<a href="https://cjyabraham.github.io/docs/quickstart/dart/" >Dart</a>
<a href="https://cjyabraham.github.io/docs/quickstart/go/" >Go</a>
<a href="https://cjyabraham.github.io/docs/quickstart/java/" >Java</a>
<a href="https://cjyabraham.github.io/docs/quickstart/android/" >Android Java</a>
<a href="https://cjyabraham.github.io/docs/quickstart/node/" >Node.js</a>
<a href="https://cjyabraham.github.io/docs/quickstart/objective-c/" >Objective-C</a>
<a href="https://cjyabraham.github.io/docs/quickstart/php/" >PHP</a>
<a href="https://cjyabraham.github.io/docs/quickstart/python/" >Python</a>
<a href="https://cjyabraham.github.io/docs/quickstart/ruby/" >Ruby</a>
<a href="https://cjyabraham.github.io/docs/quickstart/web/" >Web</a>
</div>

<div class="quickstartcol2" style="margin-top:4%">
<h3 style="margin-top:0px;">C&#43;&#43; Quickstart</h3>

    

<p class="lead">This guide gets you started with gRPC in C++ with a simple
working example.</p>

<div id="toc"></div>

<h3 id="before-you-begin">Before you begin</h3>

<h4 id="install-grpc">Install gRPC</h4>

<p>To install gRPC on your system, follow the <a href="https://github.com/grpc/grpc/blob/master/src/cpp/README.md#make">instructions to install gRPC C++ via make</a>.</p>

<p>To run the example code, please ensure <code>pkg-config</code> is installed on your
machine before you build and install gRPC in the previous step, since the
example <code>Makefile</code>s try to look up the installed gRPC path using <code>pkg-config</code>.
On Debian-based systems like Ubuntu, this can usually be done via
<code>sudo apt-get install pkg-config</code>.</p>

<h4 id="install-protocol-buffers-v3">Install Protocol Buffers v3</h4>

<p>While not mandatory to use gRPC, gRPC applications usually leverage Protocol
Buffers v3 for service definitions and data serialization, and our example code
uses Protocol Buffers as well as gRPC. If you don&rsquo;t already have it installed on
your system, you can install the version cloned alongside gRPC. First ensure
that you are running these commands in the gRPC tree you just built in the from
the previous step.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ cd third_party/protobuf
$ make <span style="color:#f92672">&amp;&amp;</span> sudo make install</code></pre></div>
<h3 id="build-the-example">Build the example</h3>

<p>Always assuming you have gRPC properly installed, go into the example&rsquo;s
directory:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ cd examples/cpp/helloworld/</code></pre></div>
<p>Let&rsquo;s build the example client and server:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ make</code></pre></div>
<p>Most failures at this point are a result of a faulty installation (or having
installed gRPC to a non-standard location. Check out <a href="https://github.com/grpc/grpc/blob/master/src/cpp/README.md#make">the installation
instructions for details</a>).</p>

<h3 id="try-it">Try it!</h3>

<p>From the <code>examples/cpp/helloworld</code> directory, run the server, which will listen
on port 50051:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ ./greeter_server</code></pre></div>
<p>From a different terminal, run the client:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ ./greeter_client</code></pre></div>
<p>If things go smoothly, you will see the <code>Greeter received: Hello world</code> in the
client side output.</p>

<p>Congratulations! You&rsquo;ve just run a client-server application with gRPC.</p>

<h3 id="update-a-grpc-service">Update a gRPC service</h3>

<p>Now let&rsquo;s look at how to update the application with an extra method on the
server for the client to call. Our gRPC service is defined using protocol
buffers; you can find out lots more about how to define a service in a <code>.proto</code>
file in <a href="/docs/guides/">What is gRPC?</a> and <a href="/docs/tutorials/basic/c/">gRPC Basics:
C++</a>. For now all you need to know is that both the server and the client
&ldquo;stub&rdquo; have a <code>SayHello</code> RPC method that takes a <code>HelloRequest</code> parameter from
the client and returns a <code>HelloResponse</code> from the server, and that this method
is defined like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-protobuf" data-lang="protobuf"><span style="color:#75715e">// The greeting service definition.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">service</span> Greeter {<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>  <span style="color:#75715e">// Sends a greeting
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">rpc</span> SayHello (HelloRequest) <span style="color:#66d9ef">returns</span> (HelloReply) {}<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>}<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e">// The request message containing the user&#39;s name.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">message</span> <span style="color:#a6e22e">HelloRequest</span> {<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>  <span style="color:#66d9ef">string</span> name <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>}<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e">// The response message containing the greetings
</span><span style="color:#75715e"></span><span style="color:#66d9ef">message</span> <span style="color:#a6e22e">HelloReply</span> {<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>  <span style="color:#66d9ef">string</span> <span style="color:#66d9ef">message</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>}</code></pre></div>
<p>Let&rsquo;s update this so that the <code>Greeter</code> service has two methods. Edit
<code>examples/protos/helloworld.proto</code> (from the root of the cloned repository) and
update it with a new <code>SayHelloAgain</code> method, with the same request and response
types:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-protobuf" data-lang="protobuf"><span style="color:#75715e">// The greeting service definition.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">service</span> Greeter {<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>  <span style="color:#75715e">// Sends a greeting
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">rpc</span> SayHello (HelloRequest) <span style="color:#66d9ef">returns</span> (HelloReply) {}<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>  <span style="color:#75715e">// Sends another greeting
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">rpc</span> SayHelloAgain (HelloRequest) <span style="color:#66d9ef">returns</span> (HelloReply) {}<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>}<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e">// The request message containing the user&#39;s name.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">message</span> <span style="color:#a6e22e">HelloRequest</span> {<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>  <span style="color:#66d9ef">string</span> name <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>}<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e">// The response message containing the greetings
</span><span style="color:#75715e"></span><span style="color:#66d9ef">message</span> <span style="color:#a6e22e">HelloReply</span> {<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>  <span style="color:#66d9ef">string</span> <span style="color:#66d9ef">message</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>}</code></pre></div>
<p>(Don&rsquo;t forget to save the file!)</p>

<h3 id="generate-grpc-code">Generate gRPC code</h3>

<p>Next we need to update the gRPC code used by our application to use the new
service definition. From the <code>examples/cpp/helloworld</code> directory:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ make</code></pre></div>
<p>This regenerates <code>helloworld.pb.{h,cc}</code> and <code>helloworld.grpc.pb.{h,cc}</code>, which
contains our generated client and server classes, as well as classes for
populating, serializing, and retrieving our request and response types.</p>

<h3 id="update-and-run-the-application">Update and run the application</h3>

<p>We now have new generated server and client code, but we still need to implement
and call the new method in the human-written parts of our example application.</p>

<h4 id="update-the-server">Update the server</h4>

<p>In the same directory, open <code>greeter_server.cc</code>. Implement the new method like
this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#66d9ef">class</span><span style="color:#960050;background-color:#1e0010"> </span><span style="color:#a6e22e">GreeterServiceImpl</span> <span style="color:#66d9ef">final</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Greeter<span style="color:#f92672">::</span>Service {
  Status SayHello(ServerContext<span style="color:#f92672">*</span> context, <span style="color:#66d9ef">const</span> HelloRequest<span style="color:#f92672">*</span> request,
                  HelloReply<span style="color:#f92672">*</span> reply) <span style="color:#66d9ef">override</span> {
     <span style="color:#75715e">// ... (pre-existing code)
</span><span style="color:#75715e"></span>  }

  Status SayHelloAgain(ServerContext<span style="color:#f92672">*</span> context, <span style="color:#66d9ef">const</span> HelloRequest<span style="color:#f92672">*</span> request,
                       HelloReply<span style="color:#f92672">*</span> reply) <span style="color:#66d9ef">override</span> {
    std<span style="color:#f92672">::</span>string prefix(<span style="color:#e6db74">&#34;Hello again &#34;</span>);
    reply<span style="color:#f92672">-&gt;</span>set_message(prefix <span style="color:#f92672">+</span> request<span style="color:#f92672">-&gt;</span>name());
    <span style="color:#66d9ef">return</span> Status<span style="color:#f92672">::</span>OK;
  }
};
</code></pre></div>
<h4 id="update-the-client">Update the client</h4>

<p>A new <code>SayHelloAgain</code> method is now available in the stub. We&rsquo;ll follow the same
pattern as for the already present <code>SayHello</code> and add a new <code>SayHelloAgain</code>
method to <code>GreeterClient</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#66d9ef">class</span><span style="color:#960050;background-color:#1e0010"> </span><span style="color:#a6e22e">GreeterClient</span> {
 <span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
  <span style="color:#75715e">// ...
</span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>string SayHello(<span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>string<span style="color:#f92672">&amp;</span> user) {
     <span style="color:#75715e">// ...
</span><span style="color:#75715e"></span>  }

  std<span style="color:#f92672">::</span>string SayHelloAgain(<span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>string<span style="color:#f92672">&amp;</span> user) {
    <span style="color:#75715e">// Follows the same pattern as SayHello.
</span><span style="color:#75715e"></span>    HelloRequest request;
    request.set_name(user);
    HelloReply reply;
    ClientContext context;

    <span style="color:#75715e">// Here we can use the stub&#39;s newly available method we just added.
</span><span style="color:#75715e"></span>    Status status <span style="color:#f92672">=</span> stub_<span style="color:#f92672">-&gt;</span>SayHelloAgain(<span style="color:#f92672">&amp;</span>context, request, <span style="color:#f92672">&amp;</span>reply);
    <span style="color:#66d9ef">if</span> (status.ok()) {
      <span style="color:#66d9ef">return</span> reply.message();
    } <span style="color:#66d9ef">else</span> {
      std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> status.error_code() <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;: &#34;</span> <span style="color:#f92672">&lt;&lt;</span> status.error_message()
                <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl;
      <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;RPC failed&#34;</span>;
    }
  }
</code></pre></div>
<p>Finally, we exercise this new method in <code>main</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">char</span><span style="color:#f92672">**</span> argv) {
  <span style="color:#75715e">// ...
</span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>string reply <span style="color:#f92672">=</span> greeter.SayHello(user);
  std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Greeter received: &#34;</span> <span style="color:#f92672">&lt;&lt;</span> reply <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl;

  reply <span style="color:#f92672">=</span> greeter.SayHelloAgain(user);
  std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Greeter received: &#34;</span> <span style="color:#f92672">&lt;&lt;</span> reply <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl;

  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div>
<h4 id="run">Run!</h4>

<p>Just like we did before, from the <code>examples/cpp/helloworld</code> directory:</p>

<ol>
<li><p>Build the client and server after having made changes:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ make</code></pre></div></li>

<li><p>Run the server</p></li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">   $ ./greeter_server</code></pre></div>
<ol>
<li>On a different terminal, run the client</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">   $ ./greeter_client</code></pre></div>
<p>You should see the updated output:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">   $ ./greeter_client
   Greeter received: Hello world
   Greeter received: Hello again world</code></pre></div>
<h3 id="what-s-next">What&rsquo;s next</h3>

<ul>
<li>Read a full explanation of how gRPC works in <a href="/docs/guides/">What is gRPC?</a>
and <a href="/docs/guides/concepts/">gRPC Concepts</a></li>
<li>Work through a more detailed tutorial in <a href="/docs/tutorials/basic/c/">gRPC Basics: C++</a></li>
<li>Explore the gRPC C++ core API in its <a href="/grpc/cpp/">reference
documentation</a></li>
</ul>

</div>
</div>

</div>

          
          

      <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

  </body>
</html>
